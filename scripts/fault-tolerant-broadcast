#!/bin/sh
set -e

go build -o bin/maelstrom-fault-tolerant-broadcast ./cmd/fault-tolerant-broadcast/main.go

mkdir -p ./log
rm -r ./log/
mkdir -p ./log
# Should pass multi-node broadcast test before we attempt adding a partition
./bin/maelstrom/maelstrom test -w broadcast --bin bin/maelstrom-fault-tolerant-broadcast --node-count 5 --time-limit 20 --rate 10

mkdir -p ./log
rm -r ./log/
mkdir -p ./log
./bin/maelstrom/maelstrom test -w broadcast --bin bin/maelstrom-fault-tolerant-broadcast --node-count 5 --time-limit 20 --rate 10 --nemesis partition
